import{s as Ve,f as y,a as R,l as Y,e as Te,g as N,h as B,H as I,c as G,d as b,m as Z,j as ae,i as S,I as d,y as z,n as Re,J as Ae,C as Fe,D as We,G as xe,K as Ge,E as Je}from"../chunks/scheduler.71239b2e.js";import{S as Ke,i as Le,t as ie,c as Qe,a as ue,b as je,d as qe,m as He,e as Oe,g as Xe}from"../chunks/index.8ab45ecd.js";import{a as Se}from"../chunks/store.fe58922c.js";import{d as Ce,m as Ye,g as Ze,a as et,c as tt,S as ot,b as De,G as st,u as lt,r as nt,e as ct,f as rt,s as Ue,h as at}from"../chunks/GridStatus.80ccee2a.js";const it=e=>{const o=Ce(e);return $e(o),o},$e=e=>{for(let o=0;o<9;o++)for(let t=0;t<9;t++)if(e[o][t].value===void 0){for(let s=1;s<=9;s++)if(Ye(e,{row:o,col:t},s)){if(e[o][t].value=s,$e(e))return!0;e[o][t].value=void 0}return!1}return!0},Be=()=>{const e=Ze(et()),o=[];for(let t=0;t<9;t++)for(let s=0;s<9;s++)o.push({row:t,col:s});for(;o.length;){const t=Math.floor(Math.random()*o.length),{row:s,col:c}=o[t];o.splice(t,1);const l=e[s][c].value;e[s][c].value=void 0,e[s][c].notes=[],e[s][c].fixed=!1,tt(e)!=="unique"&&(e[s][c].value=l)}for(let t=0;t<9;t++)for(let s=0;s<9;s++)e[t][s].value&&(e[t][s].fixed=!0);return e},ut=e=>{const o=[];for(let t=0;t<9;t++){const s={},c={},l={},i=3*Math.floor(t/3),p=3*(t%3);for(let n=0;n<9;n++){if(e[t][n].value===void 0){const f=e[t][n].notes;for(const m of f)s[m]||(s[m]=[]),s[m].push({row:t,col:n})}if(e[n][t].value===void 0){const f=e[n][t].notes;for(const m of f)c[m]||(c[m]=[]),c[m].push({row:n,col:t})}const _=Math.floor(n/3),C=n%3,a=i+_,u=p+C;if(e[a][u].value===void 0){const f=e[a][u].notes;for(const m of f)l[m]||(l[m]=[]),l[m].push({row:a,col:u})}}for(const n of Object.keys(s)){const _=Number(n);if(s[_].length===1){const{row:C,col:a}=s[_][0];o.push({type:"hidden_single_row",cause:[{row:C,col:a,notes:[_]}],effect:[{row:C,col:a,notes:e[C][a].notes.filter(u=>u!==_)}]})}}for(const n of Object.keys(c)){const _=Number(n);if(c[_].length===1){const{row:C,col:a}=c[_][0];o.push({type:"hidden_single_col",cause:[{row:C,col:a,notes:[_]}],effect:[{row:C,col:a,notes:e[C][a].notes.filter(u=>u!==_)}]})}}for(const n of Object.keys(l)){const _=Number(n);if(l[_].length===1){const{row:C,col:a}=l[_][0];o.push({type:"hidden_single_square",cause:[{row:C,col:a,notes:[_]}],effect:[{row:C,col:a,notes:e[C][a].notes.filter(u=>u!==_)}]})}}}return o},ft=e=>{const o=[];for(let t=0;t<9;t++)for(let s=0;s<9;s++)e[t][s].value===void 0&&e[t][s].notes.length===1&&o.push({type:"lone_single",cause:[{row:t,col:s,notes:[e[t][s].notes[0]]}]});return o},_t=e=>{const o=[];for(let t=0;t<9;t++){const s={},c={},l={},i=3*Math.floor(t/3),p=3*(t%3);for(let n=0;n<9;n++){if(e[t][n].value===void 0&&e[t][n].notes.length===2){const f=e[t][n].notes.join(",");if(!s[f])s[f]={row:t,col:n};else{const m={row:t,col:n,notes:[...e[t][n].notes]},T={row:s[f].row,col:s[f].col,notes:[...e[t][n].notes]},q=[];for(let w=0;w<9;w++)e[t][w].value!==void 0||e[t][w].notes.join(",")===f||q.push({row:t,col:w,notes:[...e[t][n].notes]});o.push({type:"naked_pair",cause:[m,T],effect:q})}}if(e[n][t].value===void 0&&e[n][t].notes.length===2){const f=e[n][t].notes.join(",");if(!c[f])c[f]={row:n,col:t};else{const m={row:n,col:t,notes:[...e[n][t].notes]},T={row:c[f].row,col:c[f].col,notes:[...e[n][t].notes]},q=[];for(let w=0;w<9;w++)e[w][t].value!==void 0||e[w][t].notes.join(",")===f||q.push({row:w,col:t,notes:[...e[n][t].notes]});o.push({type:"naked_pair",cause:[m,T],effect:q})}}const _=Math.floor(n/3),C=n%3,a=i+_,u=p+C;if(e[a][u].value===void 0&&e[a][u].notes.length===2){const f=e[a][u].notes.join(",");if(!l[f])l[f]={row:a,col:u};else{const m={row:a,col:u,notes:[...e[a][u].notes]},T={row:l[f].row,col:l[f].col,notes:[...e[a][u].notes]},q=[];for(let w=0;w<9;w++){const D=Math.floor(w/3),L=w%3,U=i+D,j=p+L;e[U][j].value!==void 0||e[U][j].notes.join(",")===f||q.push({row:U,col:j,notes:[...e[a][u].notes]})}o.push({type:"naked_pair",cause:[m,T],effect:q})}}}}return o};function Ie(e,o,t){const s=e.slice();return s[21]=o[t],s}function ze(e){let o,t="Remove notes",s,c;return{c(){o=y("button"),o.textContent=t},l(l){o=N(l,"BUTTON",{"data-svelte-h":!0}),I(o)!=="svelte-16z5c15"&&(o.textContent=t)},m(l,i){S(l,o,i),s||(c=z(o,"click",e[17]),s=!0)},p:xe,d(l){l&&b(o),s=!1,c()}}}function Pe(e){let o,t,s,c;function l(){return e[19](e[21])}return{c(){o=y("button"),t=Y(e[21]),this.h()},l(i){o=N(i,"BUTTON",{class:!0});var p=B(o);t=Z(p,e[21]),p.forEach(b),this.h()},h(){ae(o,"class","svelte-zwzkqm"),Ge(o,"selected",e[4]===e[21])},m(i,p){S(i,o,p),d(o,t),s||(c=z(o,"click",l),s=!0)},p(i,p){e=i,p&16&&Ge(o,"selected",e[4]===e[21])},d(i){i&&b(o),s=!1,c()}}}function Me(e){let o,t,s,c;return o=new ot({props:{gridErrors:De(e[0]),strategiesResults:e[1],grid:e[0]}}),o.$on("cellUpdate",e[6]),o.$on("computeCellNotes",e[7]),s=new st({props:{grid:e[0]}}),{c(){je(o.$$.fragment),t=R(),je(s.$$.fragment)},l(l){qe(o.$$.fragment,l),t=G(l),qe(s.$$.fragment,l)},m(l,i){He(o,l,i),S(l,t,i),He(s,l,i),c=!0},p(l,i){const p={};i&1&&(p.gridErrors=De(l[0])),i&2&&(p.strategiesResults=l[1]),i&1&&(p.grid=l[0]),o.$set(p);const n={};i&1&&(n.grid=l[0]),s.$set(n)},i(l){c||(ue(o.$$.fragment,l),ue(s.$$.fragment,l),c=!0)},o(l){ie(o.$$.fragment,l),ie(s.$$.fragment,l),c=!1},d(l){l&&b(t),Oe(o,l),Oe(s,l)}}}function ht(e){let o,t,s="Grid controls",c,l,i,p="Prev",n,_,C="New Grid",a,u,f="Solve grid",m,T,q="Reset grid",w,D,L="Remove fixed",U,j,M,fe="Notes controls",v,E,V,Q=e[2]?"Disable":"Enable",ee,_e,he,te,x,X=e[3]?"Hide":"Display",oe,de,se,P,F,ye="Highlights controls",ve,$,le,ne,ce,Ne=e[0],W,J,pe,ge,g=!e[2]&&ze(e),me=Se([1,2,3,4,5,6,7,8,9]),H=[];for(let r=0;r<9;r+=1)H[r]=Pe(Ie(e,me,r));let O=Me(e);return{c(){o=y("div"),t=y("h4"),t.textContent=s,c=R(),l=y("div"),i=y("button"),i.textContent=p,n=R(),_=y("button"),_.textContent=C,a=R(),u=y("button"),u.textContent=f,m=R(),T=y("button"),T.textContent=q,w=R(),D=y("button"),D.textContent=L,U=R(),j=y("div"),M=y("h4"),M.textContent=fe,v=R(),E=y("div"),V=y("button"),ee=Y(Q),_e=Y(" notes auto-refresh"),he=R(),g&&g.c(),te=R(),x=y("button"),oe=Y(X),de=Y(" hints"),se=R(),P=y("div"),F=y("h4"),F.textContent=ye,ve=R(),$=y("div");for(let r=0;r<9;r+=1)H[r].c();le=R(),ne=y("br"),ce=R(),O.c(),W=Te(),this.h()},l(r){o=N(r,"DIV",{});var k=B(o);t=N(k,"H4",{"data-svelte-h":!0}),I(t)!=="svelte-1h8cvtc"&&(t.textContent=s),c=G(k),l=N(k,"DIV",{class:!0});var h=B(l);i=N(h,"BUTTON",{"data-svelte-h":!0}),I(i)!=="svelte-bivxk4"&&(i.textContent=p),n=G(h),_=N(h,"BUTTON",{"data-svelte-h":!0}),I(_)!=="svelte-1oh0e6u"&&(_.textContent=C),a=G(h),u=N(h,"BUTTON",{"data-svelte-h":!0}),I(u)!=="svelte-1wjgins"&&(u.textContent=f),m=G(h),T=N(h,"BUTTON",{"data-svelte-h":!0}),I(T)!=="svelte-hocye6"&&(T.textContent=q),w=G(h),D=N(h,"BUTTON",{"data-svelte-h":!0}),I(D)!=="svelte-g7g4he"&&(D.textContent=L),h.forEach(b),k.forEach(b),U=G(r),j=N(r,"DIV",{});var A=B(j);M=N(A,"H4",{"data-svelte-h":!0}),I(M)!=="svelte-8gx0az"&&(M.textContent=fe),v=G(A),E=N(A,"DIV",{class:!0});var K=B(E);V=N(K,"BUTTON",{});var ke=B(V);ee=Z(ke,Q),_e=Z(ke," notes auto-refresh"),ke.forEach(b),he=G(K),g&&g.l(K),te=G(K),x=N(K,"BUTTON",{});var we=B(x);oe=Z(we,X),de=Z(we," hints"),we.forEach(b),K.forEach(b),A.forEach(b),se=G(r),P=N(r,"DIV",{});var re=B(P);F=N(re,"H4",{"data-svelte-h":!0}),I(F)!=="svelte-hclwgd"&&(F.textContent=ye),ve=G(re),$=N(re,"DIV",{class:!0});var Ee=B($);for(let be=0;be<9;be+=1)H[be].l(Ee);Ee.forEach(b),re.forEach(b),le=G(r),ne=N(r,"BR",{}),ce=G(r),O.l(r),W=Te(),this.h()},h(){ae(l,"class","grid-controls svelte-zwzkqm"),ae(E,"class","notes-controls svelte-zwzkqm"),ae($,"class","highlights-controls")},m(r,k){S(r,o,k),d(o,t),d(o,c),d(o,l),d(l,i),d(l,n),d(l,_),d(l,a),d(l,u),d(l,m),d(l,T),d(l,w),d(l,D),S(r,U,k),S(r,j,k),d(j,M),d(j,v),d(j,E),d(E,V),d(V,ee),d(V,_e),d(E,he),g&&g.m(E,null),d(E,te),d(E,x),d(x,oe),d(x,de),S(r,se,k),S(r,P,k),d(P,F),d(P,ve),d(P,$);for(let h=0;h<9;h+=1)H[h]&&H[h].m($,null);S(r,le,k),S(r,ne,k),S(r,ce,k),O.m(r,k),S(r,W,k),J=!0,pe||(ge=[z(i,"click",e[11]),z(_,"click",e[12]),z(u,"click",e[13]),z(T,"click",e[14]),z(D,"click",e[15]),z(V,"click",e[16]),z(x,"click",e[18])],pe=!0)},p(r,[k]){if((!J||k&4)&&Q!==(Q=r[2]?"Disable":"Enable")&&Re(ee,Q),r[2]?g&&(g.d(1),g=null):g?g.p(r,k):(g=ze(r),g.c(),g.m(E,te)),(!J||k&8)&&X!==(X=r[3]?"Hide":"Display")&&Re(oe,X),k&16){me=Se([1,2,3,4,5,6,7,8,9]);let h;for(h=0;h<9;h+=1){const A=Ie(r,me,h);H[h]?H[h].p(A,k):(H[h]=Pe(A),H[h].c(),H[h].m($,null))}for(;h<9;h+=1)H[h].d(1)}k&1&&Ve(Ne,Ne=r[0])?(Xe(),ie(O,1,1,xe),Qe(),O=Me(r),O.c(),ue(O,1),O.m(W.parentNode,W)):O.p(r,k)},i(r){J||(ue(O),J=!0)},o(r){ie(O),J=!1},d(r){r&&(b(o),b(U),b(j),b(se),b(P),b(le),b(ne),b(ce),b(W)),g&&g.d(),Ae(H,r),O.d(r),pe=!1,Fe(ge)}}}function dt(e,o,t){let s;We(e,Ue,v=>t(4,s=v));let c=Be(),l=[];const i=[Ce(c)];let p=!1,n=!1;const _=v=>{lt(v.detail.cell,v.detail.update),a()},C=v=>{nt(c,v.detail.position),a()},a=v=>{p&&at(c),n?m(c):t(1,l=[]),t(0,c),!(v!=null&&v.noHistory)&&i.push(Ce(c))},u=()=>{t(0,c=it(c)),a()},f=()=>{for(let v=0;v<9;v++)for(let E=0;E<9;E++)t(0,c[v][E].fixed=!1,c)},m=v=>{t(1,l=[...ft(v),...ut(v),..._t(v)])};return[c,l,p,n,s,i,_,C,a,u,f,()=>{t(0,c=i.pop()),a({noHistory:!0})},()=>{t(0,c=Be()),a()},()=>{u(),a()},()=>{ct(c),a()},()=>{f(),a()},()=>{t(2,p=!p),a()},()=>{rt(c),a()},()=>{t(3,n=!n),a()},v=>{Je(Ue,s=s===v?void 0:v,s)}]}class wt extends Ke{constructor(o){super(),Le(this,o,dt,ht,Ve,{})}}export{wt as component};
