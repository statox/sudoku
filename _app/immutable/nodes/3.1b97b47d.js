import{s as Fe,f as N,a as g,l as Y,e as He,g as y,h as R,H as I,c as j,d as w,m as Z,j as ae,i as S,I as d,y as z,n as ge,J as Ae,C as xe,D as Je,G as Me,K as je,E as Ke}from"../chunks/scheduler.71239b2e.js";import{S as Le,i as Qe,t as ie,c as We,a as ue,b as De,d as qe,m as Ge,e as Oe,g as Xe}from"../chunks/index.8ab45ecd.js";import{a as Se}from"../chunks/store.fe58922c.js";import{d as Ce,m as Ye,S as Ze,g as Ue,G as et,u as tt,r as ot,a as st,b as nt,s as Be,c as lt}from"../chunks/GridStatus.3292aedf.js";import{g as Re}from"../chunks/game.2da97f76.js";const ct=e=>{const o=Ce(e);return $e(o),o},$e=e=>{for(let o=0;o<9;o++)for(let t=0;t<9;t++)if(e[o][t].value===void 0){for(let n=1;n<=9;n++)if(Ye(e,{row:o,col:t},n)){if(e[o][t].value=n,$e(e))return!0;e[o][t].value=void 0}return!1}return!0},rt=e=>{const o=[];for(let t=0;t<9;t++){const n={},r={},s={},i=3*Math.floor(t/3),v=3*(t%3);for(let l=0;l<9;l++){if(e[t][l].value===void 0){const f=e[t][l].notes;for(const p of f)n[p]||(n[p]=[]),n[p].push({row:t,col:l})}if(e[l][t].value===void 0){const f=e[l][t].notes;for(const p of f)r[p]||(r[p]=[]),r[p].push({row:l,col:t})}const _=Math.floor(l/3),C=l%3,a=i+_,u=v+C;if(e[a][u].value===void 0){const f=e[a][u].notes;for(const p of f)s[p]||(s[p]=[]),s[p].push({row:a,col:u})}}for(const l of Object.keys(n)){const _=Number(l);if(n[_].length===1){const{row:C,col:a}=n[_][0];o.push({type:"hidden_single_row",cause:[{row:C,col:a,notes:[_]}],effect:[{row:C,col:a,notes:e[C][a].notes.filter(u=>u!==_)}]})}}for(const l of Object.keys(r)){const _=Number(l);if(r[_].length===1){const{row:C,col:a}=r[_][0];o.push({type:"hidden_single_col",cause:[{row:C,col:a,notes:[_]}],effect:[{row:C,col:a,notes:e[C][a].notes.filter(u=>u!==_)}]})}}for(const l of Object.keys(s)){const _=Number(l);if(s[_].length===1){const{row:C,col:a}=s[_][0];o.push({type:"hidden_single_square",cause:[{row:C,col:a,notes:[_]}],effect:[{row:C,col:a,notes:e[C][a].notes.filter(u=>u!==_)}]})}}}return o},at=e=>{const o=[];for(let t=0;t<9;t++)for(let n=0;n<9;n++)e[t][n].value===void 0&&e[t][n].notes.length===1&&o.push({type:"lone_single",cause:[{row:t,col:n,notes:[e[t][n].notes[0]]}],effect:[]});return o},it=e=>{const o=[];for(let t=0;t<9;t++){const n={},r={},s={},i=3*Math.floor(t/3),v=3*(t%3);for(let l=0;l<9;l++){if(e[t][l].value===void 0&&e[t][l].notes.length===2){const f=e[t][l].notes.join(",");if(!n[f])n[f]={row:t,col:l};else{const p={row:t,col:l,notes:[...e[t][l].notes]},H={row:n[f].row,col:n[f].col,notes:[...e[t][l].notes]},q=[];for(let b=0;b<9;b++)e[t][b].value!==void 0||e[t][b].notes.join(",")===f||q.push({row:t,col:b,notes:[...e[t][l].notes]});o.push({type:"naked_pair",cause:[p,H],effect:q})}}if(e[l][t].value===void 0&&e[l][t].notes.length===2){const f=e[l][t].notes.join(",");if(!r[f])r[f]={row:l,col:t};else{const p={row:l,col:t,notes:[...e[l][t].notes]},H={row:r[f].row,col:r[f].col,notes:[...e[l][t].notes]},q=[];for(let b=0;b<9;b++)e[b][t].value!==void 0||e[b][t].notes.join(",")===f||q.push({row:b,col:t,notes:[...e[l][t].notes]});o.push({type:"naked_pair",cause:[p,H],effect:q})}}const _=Math.floor(l/3),C=l%3,a=i+_,u=v+C;if(e[a][u].value===void 0&&e[a][u].notes.length===2){const f=e[a][u].notes.join(",");if(!s[f])s[f]={row:a,col:u};else{const p={row:a,col:u,notes:[...e[a][u].notes]},H={row:s[f].row,col:s[f].col,notes:[...e[a][u].notes]},q=[];for(let b=0;b<9;b++){const U=Math.floor(b/3),Q=b%3,B=i+U,D=v+Q;e[B][D].value!==void 0||e[B][D].notes.join(",")===f||q.push({row:B,col:D,notes:[...e[a][u].notes]})}o.push({type:"naked_pair",cause:[p,H],effect:q})}}}}return o},ut=e=>[...at(e),...rt(e),...it(e)];function Ie(e,o,t){const n=e.slice();return n[21]=o[t],n}function ze(e){let o,t="Remove notes",n,r;return{c(){o=N("button"),o.textContent=t},l(s){o=y(s,"BUTTON",{"data-svelte-h":!0}),I(o)!=="svelte-16z5c15"&&(o.textContent=t)},m(s,i){S(s,o,i),n||(r=z(o,"click",e[17]),n=!0)},p:Me,d(s){s&&w(o),n=!1,r()}}}function Pe(e){let o,t,n,r;function s(){return e[19](e[21])}return{c(){o=N("button"),t=Y(e[21]),this.h()},l(i){o=y(i,"BUTTON",{class:!0});var v=R(o);t=Z(v,e[21]),v.forEach(w),this.h()},h(){ae(o,"class","svelte-zwzkqm"),je(o,"selected",e[4]===e[21])},m(i,v){S(i,o,v),d(o,t),n||(r=z(o,"click",s),n=!0)},p(i,v){e=i,v&16&&je(o,"selected",e[4]===e[21])},d(i){i&&w(o),n=!1,r()}}}function Ve(e){let o,t,n,r;return o=new Ze({props:{gridErrors:Ue(e[0]),hints:e[1],grid:e[0]}}),o.$on("cellUpdate",e[6]),o.$on("computeCellNotes",e[7]),n=new et({props:{grid:e[0]}}),{c(){De(o.$$.fragment),t=g(),De(n.$$.fragment)},l(s){qe(o.$$.fragment,s),t=j(s),qe(n.$$.fragment,s)},m(s,i){Ge(o,s,i),S(s,t,i),Ge(n,s,i),r=!0},p(s,i){const v={};i&1&&(v.gridErrors=Ue(s[0])),i&2&&(v.hints=s[1]),i&1&&(v.grid=s[0]),o.$set(v);const l={};i&1&&(l.grid=s[0]),n.$set(l)},i(s){r||(ue(o.$$.fragment,s),ue(n.$$.fragment,s),r=!0)},o(s){ie(o.$$.fragment,s),ie(n.$$.fragment,s),r=!1},d(s){s&&w(t),Oe(o,s),Oe(n,s)}}}function ft(e){let o,t,n="Grid controls",r,s,i,v="Prev",l,_,C="New Grid",a,u,f="Solve grid",p,H,q="Reset grid",b,U,Q="Remove fixed",B,D,V,fe="Notes controls",m,E,F,W=e[2]?"Disable":"Enable",ee,_e,he,te,M,X=e[3]?"Hide":"Display",oe,de,se,P,x,Ne="Highlights controls",ve,$,ne,le,ce,ye=e[0],J,K,pe,Te,T=!e[2]&&ze(e),me=Se([1,2,3,4,5,6,7,8,9]),G=[];for(let c=0;c<9;c+=1)G[c]=Pe(Ie(e,me,c));let O=Ve(e);return{c(){o=N("div"),t=N("h4"),t.textContent=n,r=g(),s=N("div"),i=N("button"),i.textContent=v,l=g(),_=N("button"),_.textContent=C,a=g(),u=N("button"),u.textContent=f,p=g(),H=N("button"),H.textContent=q,b=g(),U=N("button"),U.textContent=Q,B=g(),D=N("div"),V=N("h4"),V.textContent=fe,m=g(),E=N("div"),F=N("button"),ee=Y(W),_e=Y(" notes auto-refresh"),he=g(),T&&T.c(),te=g(),M=N("button"),oe=Y(X),de=Y(" hints"),se=g(),P=N("div"),x=N("h4"),x.textContent=Ne,ve=g(),$=N("div");for(let c=0;c<9;c+=1)G[c].c();ne=g(),le=N("br"),ce=g(),O.c(),J=He(),this.h()},l(c){o=y(c,"DIV",{});var k=R(o);t=y(k,"H4",{"data-svelte-h":!0}),I(t)!=="svelte-1h8cvtc"&&(t.textContent=n),r=j(k),s=y(k,"DIV",{class:!0});var h=R(s);i=y(h,"BUTTON",{"data-svelte-h":!0}),I(i)!=="svelte-bivxk4"&&(i.textContent=v),l=j(h),_=y(h,"BUTTON",{"data-svelte-h":!0}),I(_)!=="svelte-1oh0e6u"&&(_.textContent=C),a=j(h),u=y(h,"BUTTON",{"data-svelte-h":!0}),I(u)!=="svelte-1wjgins"&&(u.textContent=f),p=j(h),H=y(h,"BUTTON",{"data-svelte-h":!0}),I(H)!=="svelte-hocye6"&&(H.textContent=q),b=j(h),U=y(h,"BUTTON",{"data-svelte-h":!0}),I(U)!=="svelte-g7g4he"&&(U.textContent=Q),h.forEach(w),k.forEach(w),B=j(c),D=y(c,"DIV",{});var A=R(D);V=y(A,"H4",{"data-svelte-h":!0}),I(V)!=="svelte-8gx0az"&&(V.textContent=fe),m=j(A),E=y(A,"DIV",{class:!0});var L=R(E);F=y(L,"BUTTON",{});var ke=R(F);ee=Z(ke,W),_e=Z(ke," notes auto-refresh"),ke.forEach(w),he=j(L),T&&T.l(L),te=j(L),M=y(L,"BUTTON",{});var be=R(M);oe=Z(be,X),de=Z(be," hints"),be.forEach(w),L.forEach(w),A.forEach(w),se=j(c),P=y(c,"DIV",{});var re=R(P);x=y(re,"H4",{"data-svelte-h":!0}),I(x)!=="svelte-hclwgd"&&(x.textContent=Ne),ve=j(re),$=y(re,"DIV",{class:!0});var Ee=R($);for(let we=0;we<9;we+=1)G[we].l(Ee);Ee.forEach(w),re.forEach(w),ne=j(c),le=y(c,"BR",{}),ce=j(c),O.l(c),J=He(),this.h()},h(){ae(s,"class","grid-controls svelte-zwzkqm"),ae(E,"class","notes-controls svelte-zwzkqm"),ae($,"class","highlights-controls")},m(c,k){S(c,o,k),d(o,t),d(o,r),d(o,s),d(s,i),d(s,l),d(s,_),d(s,a),d(s,u),d(s,p),d(s,H),d(s,b),d(s,U),S(c,B,k),S(c,D,k),d(D,V),d(D,m),d(D,E),d(E,F),d(F,ee),d(F,_e),d(E,he),T&&T.m(E,null),d(E,te),d(E,M),d(M,oe),d(M,de),S(c,se,k),S(c,P,k),d(P,x),d(P,ve),d(P,$);for(let h=0;h<9;h+=1)G[h]&&G[h].m($,null);S(c,ne,k),S(c,le,k),S(c,ce,k),O.m(c,k),S(c,J,k),K=!0,pe||(Te=[z(i,"click",e[11]),z(_,"click",e[12]),z(u,"click",e[13]),z(H,"click",e[14]),z(U,"click",e[15]),z(F,"click",e[16]),z(M,"click",e[18])],pe=!0)},p(c,[k]){if((!K||k&4)&&W!==(W=c[2]?"Disable":"Enable")&&ge(ee,W),c[2]?T&&(T.d(1),T=null):T?T.p(c,k):(T=ze(c),T.c(),T.m(E,te)),(!K||k&8)&&X!==(X=c[3]?"Hide":"Display")&&ge(oe,X),k&16){me=Se([1,2,3,4,5,6,7,8,9]);let h;for(h=0;h<9;h+=1){const A=Ie(c,me,h);G[h]?G[h].p(A,k):(G[h]=Pe(A),G[h].c(),G[h].m($,null))}for(;h<9;h+=1)G[h].d(1)}k&1&&Fe(ye,ye=c[0])?(Xe(),ie(O,1,1,Me),We(),O=Ve(c),O.c(),ue(O,1),O.m(J.parentNode,J)):O.p(c,k)},i(c){K||(ue(O),K=!0)},o(c){ie(O),K=!1},d(c){c&&(w(o),w(B),w(D),w(se),w(P),w(ne),w(le),w(ce),w(J)),T&&T.d(),Ae(G,c),O.d(c),pe=!1,xe(Te)}}}function _t(e,o,t){let n;Je(e,Be,m=>t(4,n=m));let r=Re(),s=[];const i=[Ce(r)];let v=!1,l=!1;const _=m=>{tt(m.detail.cell,m.detail.update),a()},C=m=>{ot(r,m.detail.position),a()},a=m=>{v&&lt(r),l?p(r):t(1,s=[]),t(0,r),!(m!=null&&m.noHistory)&&i.push(Ce(r))},u=()=>{t(0,r=ct(r)),a()},f=()=>{for(let m=0;m<9;m++)for(let E=0;E<9;E++)t(0,r[m][E].fixed=!1,r)},p=m=>{t(1,s=ut(m))};return[r,s,v,l,n,i,_,C,a,u,f,()=>{t(0,r=i.pop()),a({noHistory:!0})},()=>{t(0,r=Re()),a()},()=>{u(),a()},()=>{st(r),a()},()=>{f(),a()},()=>{t(2,v=!v),a()},()=>{nt(r),a()},()=>{t(3,l=!l),a()},m=>{Ke(Be,n=n===m?void 0:m,n)}]}class kt extends Le{constructor(o){super(),Qe(this,o,_t,ft,Fe,{})}}export{kt as component};
